<?xml version="1.0" encoding="UTF-8"?>
<module id="amplafi.flow.definitions" version="0.8.0">
    <configuration-point id="flowsFilenames" schema-id="flowsFilenames">
        Flow definitions are contributed to this configuration point
    </configuration-point>
    <configuration-point id="flowTranslators" schema-id="amplafi.factory.servicelist">
        Translators are contributed here.
    </configuration-point>
 
     <!-- SCHEMA DEFINITION FOR FLOWS -->   
     <schema id="flowsFilenames">
        <!-- used to transition from flowsSchema ( above)  -->
        <element name="definition" key-attribute="name">
            <!-- no two definitions can be named the same, the name is the unique id! -->
            <attribute name="name" required="true"/>
            <rules>
                <push-attribute attribute="name"/>
                <invoke-parent method="addElement"/>
            </rules>
        </element>
    </schema>
    
    <service-point id="FlowTranslatorResolver" interface="org.amplafi.flow.FlowTranslatorResolver">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.BaseFlowTranslatorResolver">
                <set-configuration property="flowTranslators" configuration-id="amplafi.flow.definitions.flowTranslators" />
            </construct>
        </invoke-factory>
    </service-point>    
    
    <contribution configuration-id="flowTranslators">
        <service id="UriTranslator"/>
        <service id="CalendarFlowTranslator"/>
        <service id="JsonSelfRendererFlowTranslator"/>
        <service id="FlowAwareJsonSelfRendererFlowTranslator"/>
        <service id="JSONObjectFlowTranslator"/>
        <service id="LongFlowTranslator"/>
        <service id="IntegerFlowTranslator"/>
        <service id="BooleanFlowTranslator"/>
        <service id="TimezoneFlowTranslator"/>
        <service id="ListFlowTranslator"/>
        <service id="SetFlowTranslator"/>
        <service id="MapFlowTranslator"/>
        <service id="NavigableMapFlowTranslator"/>
        <service id="EnumFlowTranslator"/>
    </contribution>
    
    <service-point id="UriTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.UriFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>  
    <service-point id="EnumFlowTranslator" interface="org.amplafi.flow.translator.InstanceSpecificFlowTranslator">
	    <invoke-factory>
            <construct class="org.amplafi.flow.translator.EnumFlowTranslator"/>
        </invoke-factory>
    </service-point>
    <service-point id="CalendarFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.CalendarFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>  
    <service-point id="JsonSelfRendererFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.JsonSelfRendererFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>
    <service-point id="FlowAwareJsonSelfRendererFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.FlowAwareJsonSelfRendererFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>
    <service-point id="JSONObjectFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.JSONObjectFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>
    <service-point id="LongFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.LongFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>         
    <service-point id="IntegerFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.IntegerFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>     
    <service-point id="BooleanFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.BooleanFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>          
    <service-point id="TimezoneFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.TimezoneFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>   
    <service-point id="ListFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.ListFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>      
    <service-point id="SetFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.SetFlowTranslator">
            </construct>
        </invoke-factory>
    </service-point>   
    <service-point id="MapFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.MapFlowTranslator">
                <set-object property="translatedClass" value="class:java.util.Map"/>
                <set-object property="defaultObjectClass" value="class:java.util.LinkedHashMap"/>
            </construct>
        </invoke-factory>
    </service-point>        
    <service-point id="NavigableMapFlowTranslator" interface="org.amplafi.flow.translator.FlowTranslator">
        <invoke-factory>
            <construct class="org.amplafi.flow.translator.MapFlowTranslator">
                <set-object property="translatedClass" value="class:java.util.NavigableMap"/>
                <set-object property="defaultObjectClass" value="class:java.util.TreeMap"/>
            </construct>
        </invoke-factory>
    </service-point>                                           
    <service-point id="FlowDefinitionsManager" interface="org.amplafi.flow.FlowDefinitionsManager">
        <invoke-factory>
            <construct class="org.amplafi.flow.impl.FlowDefinitionsManagerImpl">
                <set-configuration property="flowsFilenames" configuration-id="amplafi.flow.definitions.flowsFilenames" />
            </construct>
        </invoke-factory>
    </service-point>
</module>